library(pheatmap)
library(ggplot2)
library(rrvgo)
library(org.Dm.eg.db)
library(GOSemSim)


if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")

BiocManager::install("rrvgo", force=TRUE)

rrvgo::shiny_rrvgo()


go_terms <- c(
  "GO:0009653","GO:0048731","GO:0032501","GO:0009887","GO:0007399","GO:0048699",
  "GO:0007275","GO:0022008","GO:0048513","GO:0048869","GO:0030154","GO:0030182",
  "GO:0048856","GO:0032502","GO:0048666","GO:0000902","GO:0065007","GO:0048468",
  "GO:0050789","GO:0048667","GO:0050794","GO:0031175","GO:0048812","GO:0120039",
  "GO:0048858","GO:0007444","GO:0009888","GO:0007154","GO:0007409","GO:0007423",
  "GO:0120036","GO:0007411","GO:0023052","GO:0061564","GO:0009987","GO:0097485",
  "GO:0030030","GO:0048880","GO:0150063","GO:0001654","GO:0048749","GO:0060429",
  "GO:0065008","GO:0098609","GO:0016043","GO:0048592","GO:0090596","GO:0007560",
  "GO:0001745","GO:0002165","GO:0009886","GO:0007165","GO:0009791","GO:0071840",
  "GO:0048707","GO:0046530","GO:0007155","GO:0034330","GO:0045165","GO:0050793",
  "GO:0007552","GO:0001751","GO:0016477","GO:0001754","GO:0048736","GO:0048737",
  "GO:0050808","GO:0035220","GO:0035107","GO:0048870","GO:0035120","GO:0035114",
  "GO:0048729","GO:0050896","GO:0040007","GO:0048589","GO:0048518","GO:0042461",
  "GO:0007166","GO:0002009","GO:0048522","GO:0007476","GO:0048646","GO:0007472",
  "GO:0098742","GO:0040011","GO:0051239","GO:0034329","GO:0023051","GO:0003008",
  "GO:0007389","GO:0010646","GO:0030029","GO:0051716","GO:0042051","GO:0003002",
  "GO:0007010","GO:0030036","GO:0048477","GO:0042462","GO:0051128","GO:0003006",
  "GO:0048609","GO:0009790","GO:0060541","GO:0090132","GO:0048583","GO:0030855",
  "GO:0010631","GO:0007424","GO:0001709","GO:0051179","GO:0035295","GO:0001708",
  "GO:0007292","GO:0061061","GO:0022412","GO:0007276","GO:0009966","GO:0008037",
  "GO:0007416","GO:0090130","GO:0001667","GO:0048523","GO:0007281","GO:0007610",
  "GO:0048519","GO:0050877","GO:0001738","GO:0051093","GO:0048859","GO:0007164",
  "GO:0001736","GO:0007298","GO:0007156","GO:0007297","GO:0032879","GO:0008038",
  "GO:0051049","GO:0006810","GO:0048732","GO:0048663","GO:0008594","GO:0007447",
  "GO:0002064","GO:0007267","GO:0007517","GO:0023056","GO:0051234","GO:0010647",
  "GO:0008045","GO:0099536","GO:0022414","GO:0040008","GO:0098916","GO:0007268",
  "GO:0046552","GO:0099537","GO:0048863","GO:0035556","GO:0007186","GO:0060560",
  "GO:0035272","GO:0007431","GO:0007015","GO:0042330","GO:0097435","GO:0045595",
  "GO:0060562","GO:0007163","GO:0010160","GO:0007167","GO:0090066","GO:0001752",
  "GO:0042706","GO:0048638","GO:0022416","GO:0016358","GO:0048588","GO:0007157",
  "GO:0098657","GO:0006897","GO:0007611","GO:0048565","GO:0055123","GO:0050890",
  "GO:1902531","GO:0009967","GO:0048813","GO:0030707","GO:0007300","GO:0048259",
  "GO:0048584","GO:1990138","GO:0022603","GO:0040012","GO:0051252","GO:0050803",
  "GO:0048675","GO:0042052","GO:0048598"
)

sim_data <- godata('org.Dm.eg.db', ont = "BP")

simMatrix <- calculateSimMatrix(go_terms,
                                orgdb = "org.Dm.eg.db",
                                method = "Rel")


reduced_terms <- reduceSimMatrix(
  simMatrix,
  threshold = 0.7,
  orgdb = org.Dm.eg.db
)


treemapPlot(reduced_terms)


pheatmap(simMatrix,
         main = "GO Term Semantic Similarity",
         cluster_rows = TRUE,
         cluster_cols = TRUE,
         display_numbers = TRUE)




